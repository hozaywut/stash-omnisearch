var j=function(J){return!Array.isArray?G0(J)==="[object Array]":Array.isArray(J)},A0=function(J){if(typeof J=="string")return J;let U=J+"";return U=="0"&&1/J==-B0?"-0":U},F0=function(J){return J==null?"":A0(J)},R=function(J){return typeof J==="string"},H0=function(J){return typeof J==="number"},T0=function(J){return J===!0||J===!1||f0(J)&&G0(J)=="[object Boolean]"},Y0=function(J){return typeof J==="object"},f0=function(J){return Y0(J)&&J!==null},O=function(J){return J!==void 0&&J!==null},d=function(J){return!J.trim().length},G0=function(J){return J==null?J===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(J)},W0=function(J){let U=null,V=null,Q=null,Z=1,$=null;if(R(J)||j(J))Q=J,U=V0(J),V=u(J);else{if(!U0.call(J,"name"))throw new Error(b0("name"));const H=J.name;if(Q=H,U0.call(J,"weight")){if(Z=J.weight,Z<=0)throw new Error(I0(H))}U=V0(H),V=u(H),$=J.getFn}return{path:U,id:V,weight:Z,src:Q,getFn:$}},V0=function(J){return j(J)?J:J.split(".")},u=function(J){return j(J)?J.join("."):J},g0=function(J,U){let V=[],Q=!1;const Z=($,H,Y)=>{if(!O($))return;if(!H[Y])V.push($);else{let w=H[Y];const G=$[w];if(!O(G))return;if(Y===H.length-1&&(R(G)||H0(G)||T0(G)))V.push(F0(G));else if(j(G)){Q=!0;for(let W=0,K=G.length;W<K;W+=1)Z(G[W],H,Y+1)}else if(H.length)Z(G,H,Y+1)}};return Z(J,R(U)?U.split("."):U,0),Q?V:V[0]},x0=function(J=1,U=3){const V=new Map,Q=Math.pow(10,U);return{get(Z){const $=Z.match(y0).length;if(V.has($))return V.get($);const H=1/Math.pow($,0.5*J),Y=parseFloat(Math.round(H*Q)/Q);return V.set($,Y),Y},clear(){V.clear()}}},X0=function(J,U,{getFn:V=X.getFn,fieldNormWeight:Q=X.fieldNormWeight}={}){const Z=new x({getFn:V,fieldNormWeight:Q});return Z.setKeys(J.map(W0)),Z.setSources(U),Z.create(),Z},p0=function(J,{getFn:U=X.getFn,fieldNormWeight:V=X.fieldNormWeight}={}){const{keys:Q,records:Z}=J,$=new x({getFn:U,fieldNormWeight:V});return $.setKeys(Q),$.setIndexRecords(Z),$},m=function(J,{errors:U=0,currentLocation:V=0,expectedLocation:Q=0,distance:Z=X.distance,ignoreLocation:$=X.ignoreLocation}={}){const H=U/J.length;if($)return H;const Y=Math.abs(Q-V);if(!Z)return Y?1:H;return H+Y/Z},h0=function(J=[],U=X.minMatchCharLength){let V=[],Q=-1,Z=-1,$=0;for(let H=J.length;$<H;$+=1){let Y=J[$];if(Y&&Q===-1)Q=$;else if(!Y&&Q!==-1){if(Z=$-1,Z-Q+1>=U)V.push([Q,Z]);Q=-1}}if(J[$-1]&&$-Q>=U)V.push([Q,$-1]);return V},d0=function(J,U,V,{location:Q=X.location,distance:Z=X.distance,threshold:$=X.threshold,findAllMatches:H=X.findAllMatches,minMatchCharLength:Y=X.minMatchCharLength,includeMatches:w=X.includeMatches,ignoreLocation:G=X.ignoreLocation}={}){if(U.length>L)throw new Error(L0(L));const W=U.length,K=J.length,D=Math.max(0,Math.min(Q,K));let z=$,_=D;const B=Y>1||w,A=B?Array(K):[];let b;while((b=J.indexOf(U,_))>-1){let P=m(U,{currentLocation:b,expectedLocation:D,distance:Z,ignoreLocation:G});if(z=Math.min(P,z),_=b+W,B){let F=0;while(F<W)A[b+F]=1,F+=1}}_=-1;let S=[],v=1,k=W+K;const C0=1<<W-1;for(let P=0;P<W;P+=1){let F=0,T=k;while(F<T){if(m(U,{errors:P,currentLocation:D+T,expectedLocation:D,distance:Z,ignoreLocation:G})<=z)F=T;else k=T;T=Math.floor((k-F)/2+F)}k=T;let e=Math.max(1,D-T+1),h=H?K:Math.min(D+T,K)+W,I=Array(h+2);I[h+1]=(1<<P)-1;for(let E=h;E>=e;E-=1){let M=E-1,J0=V[J.charAt(M)];if(B)A[M]=+!!J0;if(I[E]=(I[E+1]<<1|1)&J0,P)I[E]|=(S[E+1]|S[E])<<1|1|S[E+1];if(I[E]&C0){if(v=m(U,{errors:P,currentLocation:M,expectedLocation:D,distance:Z,ignoreLocation:G}),v<=z){if(z=v,_=M,_<=D)break;e=Math.max(1,2*D-_)}}}if(m(U,{errors:P+1,currentLocation:D,expectedLocation:D,distance:Z,ignoreLocation:G})>z)break;S=I}const p={isMatch:_>=0,score:Math.max(0.001,v)};if(B){const P=h0(A,Y);if(!P.length)p.isMatch=!1;else if(w)p.indices=P}return p},u0=function(J){let U={};for(let V=0,Q=J.length;V<Q;V+=1){const Z=J.charAt(V);U[Z]=(U[Z]||0)|1<<Q-V-1}return U},Z0=function(J,U){const V=J.match(U);return V?V[1]:null},c0=function(J,U={}){return J.split(l0).map((V)=>{let Q=V.trim().split(o0).filter(($)=>$&&!!$.trim()),Z=[];for(let $=0,H=Q.length;$<H;$+=1){const Y=Q[$];let w=!1,G=-1;while(!w&&++G<Q0){const W=o[G];let K=W.isMultiMatch(Y);if(K)Z.push(new W(K,U)),w=!0}if(w)continue;G=-1;while(++G<Q0){const W=o[G];let K=W.isSingleMatch(Y);if(K){Z.push(new W(K,U));break}}}return Z})},i0=function(...J){l.push(...J)},c=function(J,U){for(let V=0,Q=l.length;V<Q;V+=1){let Z=l[V];if(Z.condition(J,U))return new Z(J,U)}return new s(J,U)},E0=function(J,U,{auto:V=!0}={}){const Q=(Z)=>{let $=Object.keys(Z);const H=s0(Z);if(!H&&$.length>1&&!i(Z))return Q($0(Z));if(r0(Z)){const w=H?Z[n.PATH]:$[0],G=H?Z[n.PATTERN]:Z[w];if(!R(G))throw new Error(S0(w));const W={keyId:u(w),pattern:G};if(V)W.searcher=c(G,U);return W}let Y={children:[],operator:$[0]};return $.forEach((w)=>{const G=Z[w];if(j(G))G.forEach((W)=>{Y.children.push(Q(W))})}),Y};if(!i(J))J=$0(J);return Q(J)},a0=function(J,{ignoreFieldNorm:U=X.ignoreFieldNorm}){J.forEach((V)=>{let Q=1;V.matches.forEach(({key:Z,norm:$,score:H})=>{const Y=Z?Z.weight:null;Q*=Math.pow(H===0&&Y?Number.EPSILON:H,(Y||1)*(U?1:$))}),V.score=Q})},t0=function(J,U){const V=J.matches;if(U.matches=[],!O(V))return;V.forEach((Q)=>{if(!O(Q.indices)||!Q.indices.length)return;const{indices:Z,value:$}=Q;let H={indices:Z,value:$};if(Q.key)H.key=Q.key.src;if(Q.idx>-1)H.refIndex=Q.idx;U.matches.push(H)})},e0=function(J,U){U.score=J.score},JJ=function(J,U,{includeMatches:V=X.includeMatches,includeScore:Q=X.includeScore}={}){const Z=[];if(V)Z.push(t0);if(Q)Z.push(e0);return J.map(($)=>{const{idx:H}=$,Y={item:U[H],refIndex:H};if(Z.length)Z.forEach((w)=>{w($,Y)});return Y})},B0=Infinity;var q0="Incorrect 'index' type",S0=(J)=>`Invalid value for key ${J}`,L0=(J)=>`Pattern length exceeds max of ${J}.`,b0=(J)=>`Missing ${J} property in key`,I0=(J)=>`Property 'weight' in key '${J}' must be a positive integer`,U0=Object.prototype.hasOwnProperty;class w0{constructor(J){this._keys=[],this._keyMap={};let U=0;J.forEach((V)=>{let Q=W0(V);this._keys.push(Q),this._keyMap[Q.id]=Q,U+=Q.weight}),this._keys.forEach((V)=>{V.weight/=U})}get(J){return this._keyMap[J]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}var v0={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},k0={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(J,U)=>J.score===U.score?J.idx<U.idx?-1:1:J.score<U.score?-1:1},M0={location:0,threshold:0.6,distance:100},m0={useExtendedSearch:!1,getFn:g0,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},X={...k0,...v0,...M0,...m0},y0=/[^ ]+/g;class x{constructor({getFn:J=X.getFn,fieldNormWeight:U=X.fieldNormWeight}={}){this.norm=x0(U,3),this.getFn=J,this.isCreated=!1,this.setIndexRecords()}setSources(J=[]){this.docs=J}setIndexRecords(J=[]){this.records=J}setKeys(J=[]){this.keys=J,this._keysMap={},J.forEach((U,V)=>{this._keysMap[U.id]=V})}create(){if(this.isCreated||!this.docs.length)return;if(this.isCreated=!0,R(this.docs[0]))this.docs.forEach((J,U)=>{this._addString(J,U)});else this.docs.forEach((J,U)=>{this._addObject(J,U)});this.norm.clear()}add(J){const U=this.size();if(R(J))this._addString(J,U);else this._addObject(J,U)}removeAt(J){this.records.splice(J,1);for(let U=J,V=this.size();U<V;U+=1)this.records[U].i-=1}getValueForItemAtKeyId(J,U){return J[this._keysMap[U]]}size(){return this.records.length}_addString(J,U){if(!O(J)||d(J))return;let V={v:J,i:U,n:this.norm.get(J)};this.records.push(V)}_addObject(J,U){let V={i:U,$:{}};this.keys.forEach((Q,Z)=>{let $=Q.getFn?Q.getFn(J):this.getFn(J,Q.path);if(!O($))return;if(j($)){let H=[];const Y=[{nestedArrIndex:-1,value:$}];while(Y.length){const{nestedArrIndex:w,value:G}=Y.pop();if(!O(G))continue;if(R(G)&&!d(G)){let W={v:G,i:w,n:this.norm.get(G)};H.push(W)}else if(j(G))G.forEach((W,K)=>{Y.push({nestedArrIndex:K,value:W})})}V.$[Z]=H}else if(R($)&&!d($)){let H={v:$,n:this.norm.get($)};V.$[Z]=H}}),this.records.push(V)}toJSON(){return{keys:this.keys,records:this.records}}}var L=32;class s{constructor(J,{location:U=X.location,threshold:V=X.threshold,distance:Q=X.distance,includeMatches:Z=X.includeMatches,findAllMatches:$=X.findAllMatches,minMatchCharLength:H=X.minMatchCharLength,isCaseSensitive:Y=X.isCaseSensitive,ignoreLocation:w=X.ignoreLocation}={}){if(this.options={location:U,threshold:V,distance:Q,includeMatches:Z,findAllMatches:$,minMatchCharLength:H,isCaseSensitive:Y,ignoreLocation:w},this.pattern=Y?J:J.toLowerCase(),this.chunks=[],!this.pattern.length)return;const G=(K,D)=>{this.chunks.push({pattern:K,alphabet:u0(K),startIndex:D})},W=this.pattern.length;if(W>L){let K=0;const D=W%L,z=W-D;while(K<z)G(this.pattern.substr(K,L),K),K+=L;if(D){const _=W-L;G(this.pattern.substr(_),_)}}else G(this.pattern,0)}searchIn(J){const{isCaseSensitive:U,includeMatches:V}=this.options;if(!U)J=J.toLowerCase();if(this.pattern===J){let z={isMatch:!0,score:0};if(V)z.indices=[[0,J.length-1]];return z}const{location:Q,distance:Z,threshold:$,findAllMatches:H,minMatchCharLength:Y,ignoreLocation:w}=this.options;let G=[],W=0,K=!1;this.chunks.forEach(({pattern:z,alphabet:_,startIndex:B})=>{const{isMatch:A,score:b,indices:S}=d0(J,z,_,{location:Q+B,distance:Z,threshold:$,findAllMatches:H,minMatchCharLength:Y,includeMatches:V,ignoreLocation:w});if(A)K=!0;if(W+=b,A&&S)G=[...G,...S]});let D={isMatch:K,score:K?W/this.chunks.length:1};if(K&&V)D.indices=G;return D}}class C{constructor(J){this.pattern=J}static isMultiMatch(J){return Z0(J,this.multiRegex)}static isSingleMatch(J){return Z0(J,this.singleRegex)}search(){}}class z0 extends C{constructor(J){super(J)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(J){const U=J===this.pattern;return{isMatch:U,score:U?0:1,indices:[0,this.pattern.length-1]}}}class K0 extends C{constructor(J){super(J)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(J){const V=J.indexOf(this.pattern)===-1;return{isMatch:V,score:V?0:1,indices:[0,J.length-1]}}}class D0 extends C{constructor(J){super(J)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(J){const U=J.startsWith(this.pattern);return{isMatch:U,score:U?0:1,indices:[0,this.pattern.length-1]}}}class _0 extends C{constructor(J){super(J)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(J){const U=!J.startsWith(this.pattern);return{isMatch:U,score:U?0:1,indices:[0,J.length-1]}}}class O0 extends C{constructor(J){super(J)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(J){const U=J.endsWith(this.pattern);return{isMatch:U,score:U?0:1,indices:[J.length-this.pattern.length,J.length-1]}}}class N0 extends C{constructor(J){super(J)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(J){const U=!J.endsWith(this.pattern);return{isMatch:U,score:U?0:1,indices:[0,J.length-1]}}}class r extends C{constructor(J,{location:U=X.location,threshold:V=X.threshold,distance:Q=X.distance,includeMatches:Z=X.includeMatches,findAllMatches:$=X.findAllMatches,minMatchCharLength:H=X.minMatchCharLength,isCaseSensitive:Y=X.isCaseSensitive,ignoreLocation:w=X.ignoreLocation}={}){super(J);this._bitapSearch=new s(J,{location:U,threshold:V,distance:Q,includeMatches:Z,findAllMatches:$,minMatchCharLength:H,isCaseSensitive:Y,ignoreLocation:w})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(J){return this._bitapSearch.searchIn(J)}}class a extends C{constructor(J){super(J)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(J){let U=0,V;const Q=[],Z=this.pattern.length;while((V=J.indexOf(this.pattern,U))>-1)U=V+Z,Q.push([V,U-1]);const $=!!Q.length;return{isMatch:$,score:$?0:1,indices:Q}}}var o=[z0,a,D0,_0,N0,O0,K0,r],Q0=o.length,o0=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,l0="|",n0=new Set([r.type,a.type]);class P0{constructor(J,{isCaseSensitive:U=X.isCaseSensitive,includeMatches:V=X.includeMatches,minMatchCharLength:Q=X.minMatchCharLength,ignoreLocation:Z=X.ignoreLocation,findAllMatches:$=X.findAllMatches,location:H=X.location,threshold:Y=X.threshold,distance:w=X.distance}={}){this.query=null,this.options={isCaseSensitive:U,includeMatches:V,minMatchCharLength:Q,findAllMatches:$,ignoreLocation:Z,location:H,threshold:Y,distance:w},this.pattern=U?J:J.toLowerCase(),this.query=c0(this.pattern,this.options)}static condition(J,U){return U.useExtendedSearch}searchIn(J){const U=this.query;if(!U)return{isMatch:!1,score:1};const{includeMatches:V,isCaseSensitive:Q}=this.options;J=Q?J:J.toLowerCase();let Z=0,$=[],H=0;for(let Y=0,w=U.length;Y<w;Y+=1){const G=U[Y];$.length=0,Z=0;for(let W=0,K=G.length;W<K;W+=1){const D=G[W],{isMatch:z,indices:_,score:B}=D.search(J);if(z){if(Z+=1,H+=B,V){const A=D.constructor.type;if(n0.has(A))$=[...$,..._];else $.push(_)}}else{H=0,Z=0,$.length=0;break}}if(Z){let W={isMatch:!0,score:H/Z};if(V)W.indices=$;return W}}return{isMatch:!1,score:1}}}var l=[],y={AND:"$and",OR:"$or"},n={PATH:"$path",PATTERN:"$val"},i=(J)=>!!(J[y.AND]||J[y.OR]),s0=(J)=>!!J[n.PATH],r0=(J)=>!j(J)&&Y0(J)&&!i(J),$0=(J)=>({[y.AND]:Object.keys(J).map((U)=>({[U]:J[U]}))});class f{constructor(J,U={},V){this.options={...X,...U},this.options.useExtendedSearch,this._keyStore=new w0(this.options.keys),this.setCollection(J,V)}setCollection(J,U){if(this._docs=J,U&&!(U instanceof x))throw new Error(q0);this._myIndex=U||X0(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(J){if(!O(J))return;this._docs.push(J),this._myIndex.add(J)}remove(J=()=>!1){const U=[];for(let V=0,Q=this._docs.length;V<Q;V+=1){const Z=this._docs[V];if(J(Z,V))this.removeAt(V),V-=1,Q-=1,U.push(Z)}return U}removeAt(J){this._docs.splice(J,1),this._myIndex.removeAt(J)}getIndex(){return this._myIndex}search(J,{limit:U=-1}={}){const{includeMatches:V,includeScore:Q,shouldSort:Z,sortFn:$,ignoreFieldNorm:H}=this.options;let Y=R(J)?R(this._docs[0])?this._searchStringList(J):this._searchObjectList(J):this._searchLogical(J);if(a0(Y,{ignoreFieldNorm:H}),Z)Y.sort($);if(H0(U)&&U>-1)Y=Y.slice(0,U);return JJ(Y,this._docs,{includeMatches:V,includeScore:Q})}_searchStringList(J){const U=c(J,this.options),{records:V}=this._myIndex,Q=[];return V.forEach(({v:Z,i:$,n:H})=>{if(!O(Z))return;const{isMatch:Y,score:w,indices:G}=U.searchIn(Z);if(Y)Q.push({item:Z,idx:$,matches:[{score:w,value:Z,norm:H,indices:G}]})}),Q}_searchLogical(J){const U=E0(J,this.options),V=(H,Y,w)=>{if(!H.children){const{keyId:W,searcher:K}=H,D=this._findMatches({key:this._keyStore.get(W),value:this._myIndex.getValueForItemAtKeyId(Y,W),searcher:K});if(D&&D.length)return[{idx:w,item:Y,matches:D}];return[]}const G=[];for(let W=0,K=H.children.length;W<K;W+=1){const D=H.children[W],z=V(D,Y,w);if(z.length)G.push(...z);else if(H.operator===y.AND)return[]}return G},Q=this._myIndex.records,Z={},$=[];return Q.forEach(({$:H,i:Y})=>{if(O(H)){let w=V(U,H,Y);if(w.length){if(!Z[Y])Z[Y]={idx:Y,item:H,matches:[]},$.push(Z[Y]);w.forEach(({matches:G})=>{Z[Y].matches.push(...G)})}}}),$}_searchObjectList(J){const U=c(J,this.options),{keys:V,records:Q}=this._myIndex,Z=[];return Q.forEach(({$,i:H})=>{if(!O($))return;let Y=[];if(V.forEach((w,G)=>{Y.push(...this._findMatches({key:w,value:$[G],searcher:U}))}),Y.length)Z.push({idx:H,item:$,matches:Y})}),Z}_findMatches({key:J,value:U,searcher:V}){if(!O(U))return[];let Q=[];if(j(U))U.forEach(({v:Z,i:$,n:H})=>{if(!O(Z))return;const{isMatch:Y,score:w,indices:G}=V.searchIn(Z);if(Y)Q.push({score:w,key:J,value:Z,idx:$,norm:H,indices:G})});else{const{v:Z,n:$}=U,{isMatch:H,score:Y,indices:w}=V.searchIn(Z);if(H)Q.push({score:Y,key:J,value:Z,norm:$,indices:w})}return Q}}f.version="7.0.0";f.createIndex=X0;f.parseIndex=p0;f.config=X;f.parseQuery=E0;i0(P0);var R0=`
query FindMatches(\$performer_filter: FindFilterType, \$tag_filter: FindFilterType, \$scene_filter: FindFilterType, \$studio_filter: FindFilterType) {
  findStudios(filter: \$studio_filter){
    count
    studios {
      id
      name
      image_path
    }
  }
  findPerformers(filter: \$performer_filter) {
    count
    performers {
      id
      name
      details
      disambiguation
      alias_list
      image_path
    }
  }
  findTags(filter: \$tag_filter) {
    count
    tags {
      id
      name
      aliases
      image_path
    }
  }
  findScenes(filter: \$scene_filter) {
    count
    scenes {
      id
      title
      files {
        id
      }
      paths {
        screenshot
      }
      details
    }
  }
}
`;async function YJ(J){const U=await XJ(N.value);let V=[];V=V.concat(VJ.map((Z)=>({id:Z,label:Z,url:"/"+Z,type:"system"}))),V=V.concat(UJ.map((Z)=>({id:Z,label:"settings -> "+Z,url:"/settings?tab="+Z,type:"system"}))),V=V.concat(U),V=new f(V,{keys:[{name:"label",weight:10},{name:"aliases",weight:5},{name:"details",weight:1}],shouldSort:!0,threshold:0.4}).search(N.value,{limit:QJ}).map((Z)=>Z.item),wJ(V.sort((Z,$)=>Z.label.localeCompare($.label)))}var UJ=["tasks","plugins","interface","security","stats"],VJ=["scenes","images","movies","markers","galleries","performers","tags","studios"],ZJ=10,QJ=10,$J=document.body,q=document.createElement("div");q.id="omnisearch";$J.appendChild(q);var t=document.createElement("div");t.classList.add("omnisearch-backdrop");t.addEventListener("click",()=>{q.classList.remove("visible"),N.blur(),N.value=""});q.appendChild(t);var N=document.createElement("input");N.id="omnisearch-search-input";N.classList.add("omnisearch-input");N.type="text";N.placeholder="\u2318 + / ";q.appendChild(N);var g=document.createElement("div");g.id="search-results";g.classList.add("omnisearch-results");q.appendChild(g);var HJ=(J,U)=>{let V;return(...Q)=>{clearTimeout(V),V=setTimeout(()=>J(Q),U)}};N.addEventListener("input",HJ((J)=>YJ(J),100));document.addEventListener("keydown",(J)=>{if(J.key==="/"&&J.metaKey)q.classList.add("visible"),N.focus();else if(J.key==="Escape")q.classList.remove("visible"),N.blur(),N.value=""});var j0=(J)=>{const U=["performer","scene","tag","scene","studio"];if(J.type==="system")return window.location.href=J.url;else if(!U.includes(J.type))return;window.location.href=`/${J.type}s/${J.id}`},GJ=(J)=>{const U=document.querySelectorAll(".omnisearch-result"),V=document.createElement("div");V.classList.add("omnisearch-result"),V.addEventListener("click",(w)=>j0(J)),V.tabIndex=0,V.addEventListener("keydown",(w)=>{switch(console.log(w),w.key){case"Enter":j0(J);break;case" ":w.preventDefault(),[...U].map((G)=>G.setAttribute("class","omnisearch-result")),V.classList.toggle("expanded");break;default:break}});const Q=document.createElement("div");Q.classList.add("omnisearch-result-header");const Z=document.createElement("div");Z.classList.add("omnisearch-result-type"),Z.textContent="["+J.type[0]+"]",Q.appendChild(Z);const $=document.createElement("div");$.classList.add("omnisearch-result-title"),$.textContent=J.label,$.title=J?.details?J.details:"",Q.appendChild($);const H=document.createElement("div");H.classList.add("omnisearch-result-details"),H.textContent=J?.details?J.details:"",V.appendChild(H);const Y=document.createElement("img");return Y.classList.add("omnisearch-result-image"),Y.src=J.image,V.appendChild(Y),V.appendChild(Q),V},wJ=(J)=>{g.innerHTML="",J.forEach((U)=>{g.appendChild(GJ(U))})},WJ=(J,U)=>fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({variables:U,query:J})}).then((V)=>V.json()).then((V)=>V.data),XJ=async(J)=>{const U=J.trim().replace("/",""),V={sort:"name",direction:"ASC"},Q={sort:"name",direction:"ASC"},Z={sort:"rating",direction:"DESC"},$={sort:"created_at",direction:"DESC"},H={q:U,page:1,per_page:ZJ},Y={studio_filter:{...H,...Q},performer_filter:{...H,...Z},tag_filter:{...H,...V},scene_filter:{...H,...$}},w=await WJ(R0,Y),G=w.findStudios.studios.map((z)=>({id:z.id,type:"studio",label:z.name,details:"",image:z.image_path})),W=w.findTags.tags.map((z)=>({id:z.id,type:"tag",label:z.name,aliases:z.aliases,details:"",image:z.image_path})),K=w.findPerformers.performers.map((z)=>({id:z.id,type:"performer",label:z.name,aliases:[...z.alias_list,z.disambiguation],details:"",image:z.image_path})),D=w.findScenes.scenes.map((z)=>({id:z.id,type:"scene",label:z.title||z.files[0].path,aliases:"",details:z.details,image:z.paths.screenshot}));return[...W,...K,...D,...G]};
